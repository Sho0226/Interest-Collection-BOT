# 利子徴収ボット

## 概要

利子徴収ボットは、Discord 上で借金管理を効率的に行うためのツールです。このボットを使用することで、借金の記録、利率設定、返済管理、総合計の確認などを簡単に実現できます。また、初月は利子を換算しない仕様が含まれており、公平な計算を行います。

---

## 主な機能

### コマンド一覧

1. **`/borrow [金額] [貸し主]`**

   - 借金を記録します。指定した貸し主から指定した金額を借りたこととして記録されます。
   - 初月の利子は「0 円」に設定されます。

2. **`/interest [貸し主] [利率]`**

   - 指定した貸し主に対する利率を設定します。利率は「%」で指定します（例: 5%）。
   - 利率に基づいて毎月の固定利子額が計算されます。

3. **`/return [金額] [貸し主]`**

   - 借金を返済します。指定した貸し主に対して返済した金額を記録します。
   - 借金が返済されると残高が減少します。返済額が借金総額を超えた場合、その貸し主との借金記録は削除されます。

4. **`/total`**

   - 現在の総借金額、総利子額、総合計額を表示します。
   - 初月（30 日未満）の利子は計算に含まれません。
   - 各貸し主ごとの詳細情報（借金額、利子額、合計）も表示されます。

5. **`/tips`**
   - 利用可能なすべてのコマンドとその説明を表示します。

---

## その他の機能

1. **FastAPI サーバー統合**

   - FastAPI サーバーが統合されており、ボットの稼働状況を確認できます。

2. **月次更新（`monthly_update`）**
   - 毎月の初めに借り主に新しい利子情報を通知します。
   - 利率に基づいて固定利子額が計算され、通知メッセージが送信されます。

---

## インストール方法

### 必要条件

- Python 3.9 以上
- Discord API トークン
- 必要なライブラリ: `discord.py`, `fastapi`, `uvicorn`, `python-dotenv`

### 手順

1. リポジトリをクローンまたはダウンロードします。

   ```bash
   git clone https://github.com/your-repo/interest-bot.git
   cd interest-bot
   ```

2. 必要なライブラリをインストールします。

   ```bash
   pip install -r requirements.txt
   ```

3. `.env`ファイルを作成し、Discord API トークンを設定します。

   ```
   TOKEN=あなたのDiscordボットトークン
   PORT=8080
   ```

4. ボットを起動します。
   ```bash
   python main.py
   ```

---

## 使い方

### ボットの招待リンク作成

1. Discord Developer Portal でボットアプリケーションを作成します。
2. OAuth2 タブで以下のスコープと権限を選択して招待リンクを生成します：
   - スコープ: `bot`, `applications.commands`
   - 権限: 必要に応じて設定（例: メッセージ送信権限）

### コマンド使用例

- 借りる:
  ```
  /borrow 1000 @lender_username
  ```
- 利率設定:
  ```
  /interest @lender_username 5
  ```
- 返済:
  ```
  /return 500 @lender_username
  ```
- 合計確認:
  ```
  /total
  ```

---

## 注意事項

- 初月（借金発生日から 30 日未満）は利子が計算されません。
- ボット再起動時にデータが消失するため、データ永続化（データベース導入）を推奨します。

---
